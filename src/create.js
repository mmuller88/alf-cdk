"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const aws_sdk_1 = require("aws-sdk");
const db = new aws_sdk_1.DynamoDB.DocumentClient();
const TABLE_NAME = process.env.TABLE_NAME || '';
exports.handler = async (data = {}) => {
    console.debug('insert item request: ' + JSON.stringify(data));
    var item = typeof data === 'object' ? data : JSON.parse(data);
    // item['last_status'] = {status: item['status'], time: new Date()};
    // item['expectedStatus'] = 'running';
    const params = {
        TableName: TABLE_NAME,
        Item: item
    };
    console.debug('params: ' + JSON.stringify(params));
    const putResult = await db.put(params).promise();
    return { statusCode: 201, item: item, putResult: putResult };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3JlYXRlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiY3JlYXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEscUNBQW1DO0FBQ25DLE1BQU0sRUFBRSxHQUFHLElBQUksa0JBQVEsQ0FBQyxjQUFjLEVBQUUsQ0FBQztBQUN6QyxNQUFNLFVBQVUsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsSUFBSSxFQUFFLENBQUM7QUFFbkMsUUFBQSxPQUFPLEdBQUcsS0FBSyxFQUFFLE9BQVksRUFBRSxFQUFnQixFQUFFO0lBQzVELE9BQU8sQ0FBQyxLQUFLLENBQUMsdUJBQXVCLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBRTlELElBQUksSUFBSSxHQUFRLE9BQU8sSUFBSSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRW5FLG9FQUFvRTtJQUNwRSxzQ0FBc0M7SUFFdEMsTUFBTSxNQUFNLEdBQXlDO1FBQ25ELFNBQVMsRUFBRSxVQUFVO1FBQ3JCLElBQUksRUFBRSxJQUFJO0tBQ1gsQ0FBQztJQUVGLE9BQU8sQ0FBQyxLQUFLLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUNuRCxNQUFNLFNBQVMsR0FBRyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUM7SUFDakQsT0FBTyxFQUFFLFVBQVUsRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFDLENBQUM7QUFDOUQsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRHluYW1vREIgfSBmcm9tICdhd3Mtc2RrJztcbmNvbnN0IGRiID0gbmV3IER5bmFtb0RCLkRvY3VtZW50Q2xpZW50KCk7XG5jb25zdCBUQUJMRV9OQU1FID0gcHJvY2Vzcy5lbnYuVEFCTEVfTkFNRSB8fCAnJztcblxuZXhwb3J0IGNvbnN0IGhhbmRsZXIgPSBhc3luYyAoZGF0YTogYW55ID0ge30pOiBQcm9taXNlPGFueT4gPT4ge1xuICBjb25zb2xlLmRlYnVnKCdpbnNlcnQgaXRlbSByZXF1ZXN0OiAnICsgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuXG4gIHZhciBpdGVtOiBhbnkgPSB0eXBlb2YgZGF0YSA9PT0gJ29iamVjdCcgPyBkYXRhIDogSlNPTi5wYXJzZShkYXRhKTtcblxuICAvLyBpdGVtWydsYXN0X3N0YXR1cyddID0ge3N0YXR1czogaXRlbVsnc3RhdHVzJ10sIHRpbWU6IG5ldyBEYXRlKCl9O1xuICAvLyBpdGVtWydleHBlY3RlZFN0YXR1cyddID0gJ3J1bm5pbmcnO1xuXG4gIGNvbnN0IHBhcmFtczogRHluYW1vREIuRG9jdW1lbnRDbGllbnQuUHV0SXRlbUlucHV0ID0ge1xuICAgIFRhYmxlTmFtZTogVEFCTEVfTkFNRSxcbiAgICBJdGVtOiBpdGVtXG4gIH07XG5cbiAgY29uc29sZS5kZWJ1ZygncGFyYW1zOiAnICsgSlNPTi5zdHJpbmdpZnkocGFyYW1zKSk7XG4gIGNvbnN0IHB1dFJlc3VsdCA9IGF3YWl0IGRiLnB1dChwYXJhbXMpLnByb21pc2UoKTtcbiAgcmV0dXJuIHsgc3RhdHVzQ29kZTogMjAxLCBpdGVtOiBpdGVtLCBwdXRSZXN1bHQ6IHB1dFJlc3VsdH07XG59O1xuIl19